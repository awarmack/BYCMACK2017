{
    "collab_server" : "",
    "contents" : "#Performance analysis vs. Polars\n\nsource(\"./src/loadData.R\")\nsource(\"./src/loadPolars.R\")\n\n\n\nlibrary(akima)\nlibrary(ggplot2)\n\n\n\n# get the polar targets\ntargets <- interpp(x=pol$BAW, \n                      y=pol$VAW, \n                      z=pol$V, \n                      xo = perf$AWA, \n                      yo= perf$AWS,\n                      linear=FALSE,\n                      extrap=FALSE,\n                      duplicate = \"mean\")\n\n#Calculate Measurables\nperf$target.SOG <- targets$z\nperf$diff.SOG <- perf$SOG - perf$target.SOG\nperf$pol.perc <- (perf$SOG / perf$target.SOG) * 100\n\n\n#plot the performance\nggplot() + \n  geom_point(data=perf,  aes(x=AWA, y=SOG, color=AWS), alpha=0.7) + \n  coord_polar(\"x\") + \n  scale_x_continuous(limits=c(0,360), breaks=seq(0,360, 15))+\n  scale_y_continuous(limits=c(0,8), breaks=seq(0,8, by=2))+\n  scale_color_gradientn(colors=rainbow(5), breaks=seq(0,30, 5))+\n  ggtitle(\"Speed Over Ground [SOG] by Apparent Wind Angle and Wind Speed\")\n\nggsave(\"./figs/01_SOG_by AWA and AWS.png\", width=10, height=10, units=\"cm\", scale=2)\n\n\n\n\n#histogram of Apparent Wind Angle\nggplot(perf, aes(AWA, fill=AWS.range)) + \n  geom_histogram(binwidth = 15, position = \"stack\") + \n  coord_polar() + \n  scale_x_continuous(limits=c(0,360), breaks=seq(0,360,15), name = \"Apparent Wind Angle [AWA]\")+\n  scale_color_discrete(name=\"AWS Range [kts]\")+\n  ggtitle(\"Distribution of Apparent Wind & Direction \")\n\nggsave(\"./figs/02_Distribution Apparent Wind and Direction.png\", width=10, height=10, units=\"cm\", scale=2)\n\n\n\n#plot the path\nlibrary(ggmap)\nmap_lims <- c(min(perf$LON), min(perf$LAT), max(perf$LON), max(perf$LAT)) \n\nlkhuron <- get_map(location = map_lims, zoom=8)\n\nggmap(lkhuron) + \n  geom_path(data=perf, aes(x=LON, y=LAT, color=SOG), size=2) +\n  scale_color_gradientn(colors=rainbow(5), limits=c(0,10), breaks=seq(0,10, 2))\n\nggmap(lkhuron) + \n  geom_path(data=perf, aes(x=LON, y=LAT, color=pol.perc), size=2)+\n  scale_color_gradient2(midpoint=100, mid=\"blue\", name=\"% of Polar\")\n\n\n#Speed over time\n\nt_lims <- c(as.POSIXct(\"2017-07-22 20:00:00\"), as.POSIXct(\"2017-07-24 04:00:00\"))\n\nggplot(perf, aes(x=TIME.M, y=SOG, color=SOG)) + geom_path() +\n  ggtitle(\"GPS Speed Over Ground\")\n\nggplot(perf) + \n  geom_path(aes(x=TIME.M, y=SOG, color=pol.perc), size=1, lineend=\"round\") +\n  ggtitle(\"GPS Speed Over Ground vs. Target\")+\n  scale_color_gradientn(colors=rainbow(5), breaks=seq(0,120, by=20), name= \"% of Target\")+\n  scale_x_datetime(breaks=date_breaks(\"2 hours\"), date_labels = \"%a %H:%M\")+\n  geom_path(aes(x=TIME.M, y=target.SOG, linetype=\"Target SOG\"))+scale_linetype(name=\"Polars\")\n\n\n\n\n\n#histogram of difference vs. Target\nggplot(perf, aes(pol.perc)) + geom_histogram(col=\"black\") + scale_x_continuous(breaks=seq(0,150, by=15))\n  \n\npol_labels <- pol[pol$BTW==180, ]\n\n#difference vs. Polar\nggplot() + \n  geom_path(data=pol, aes(x=BAW, y=V, group=VTW)) + \n  coord_polar(\"x\") + \n  scale_x_continuous(limits=c(0,360), breaks=seq(0,360, 15), name=\"Apparent Wind Angle AWA\") + \n  scale_y_continuous(name=\"SOG\")+\n  geom_vline(xintercept=0)+\n  geom_vline(xintercept=90)+\n  geom_vline(xintercept=180)+\n  geom_vline(xintercept=270)+\n  ggtitle(\"% of Polar Performance by AWA\")+\n  geom_point(data=perf, aes(x=AWA, y=SOG, color=pol.perc))+\n  scale_color_gradientn(colors=rainbow(5), breaks=seq(0,120, by=20), name= \"% of Target\")+\n  geom_text(data=pol_labels, aes(x=BTW, y=V, label=VTW), hjust=1)\n\n\nggplot(perf, aes(x=TIME.M, y=SOG, color=pol.perc)) + geom_point() + \n  scale_color_gradientn(colors=rainbow(5), breaks=seq(30, 120, 20))+\n  geom_path(aes(x=TIME.M, y=target.SOG), color=\"black\")\n\n\nggplot(perf)+geom_histogram(aes(pol.perc), bins=30, color=\"black\")+scale_x_continuous(breaks=seq(0, 150, by=10))+\n  geom_vline(col=\"red\", xintercept=mean(perf$pol.perc, na.rm = TRUE))\n\nggplot(perf)+geom_histogram(aes(pol.perc, fill=AWS.range), bins=30, color=\"black\")+scale_x_continuous(breaks=seq(0, 150, by=10))+\n  geom_vline(col=\"red\", xintercept=mean(perf$pol.perc, na.rm = TRUE))+facet_grid(AWS.range ~ .)\n",
    "created" : 1502412304120.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3088342129",
    "id" : "33AF33D5",
    "lastKnownWriteTime" : 1502414006,
    "last_content_update" : 1502414006617,
    "path" : "C:/Users/AWarmack/Dropbox/projects/sailing/BYCMACK2017/src/perfAnalysis.R",
    "project_path" : "src/perfAnalysis.R",
    "properties" : {
        "source_window_id" : "wnfxhz151kw1a",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}